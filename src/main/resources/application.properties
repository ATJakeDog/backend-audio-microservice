spring.application.name=GANTone
server.port=${PORT:8080}

# === DATABASE (SUPABASE POOLER FIX) ===
# Используем URL дважды, чтобы удовлетворить и Spring, и Hibernate напрямую
spring.datasource.url=jdbc:postgresql://aws-1-ap-southeast-2.pooler.supabase.com:6543/postgres?prepareThreshold=0
jakarta.persistence.jdbc.url=jdbc:postgresql://aws-1-ap-southeast-2.pooler.supabase.com:6543/postgres?prepareThreshold=0
spring.datasource.username=postgres.indfolgrefrdhmsyswus
spring.datasource.password=ATJakeDog27$
spring.datasource.driver-class-name=org.postgresql.Driver

# ЖЕСТКОЕ УКАЗАНИЕ ДИАЛЕКТА (чтобы не было ошибки Dialect metadata)
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# Оптимизация под пуллер
spring.datasource.hikari.maximum-pool-size=3
spring.datasource.hikari.connection-timeout=30000
spring.jpa.hibernate.ddl-auto=update
# Отключаем попытки Hibernate сканировать базу при старте
spring.jpa.properties.hibernate.temp.use_jdbc_metadata_defaults=false
spring.jpa.properties.hibernate.boot.allow_jdbc_metadata_access=false

# === AIVEN KAFKA ===
spring.kafka.bootstrap-servers=audio-microservice-audio-microservice.b.aivencloud.com:10936
spring.kafka.properties.security.protocol=SSL

# Настройка Trust Store (оставляем PEM, с ним проблем нет)
spring.kafka.ssl.trust-store-type=PEM
spring.kafka.ssl.trust-store-certificates=-----BEGIN CERTIFICATE-----\nMIIERDCCAqygAwIBAgIUX2+dZFgO7TOL1mr0kDEKpG7s3JwwDQYJKoZIhvcNAQEM\nBQAwOjE4MDYGA1UEAwwvNGRiNzk3MGYtZTljOC00OWU0LWI0NDQtNzg0OGE1YTY5\nMzc4IFByb2plY3QgQ0EwHhcNMjYwMjIwMTkwNzA0WhcNMzYwMjE4MTkwNzA0WjA6\nMTgwNgYDVQQDDC80ZGI3OTcwZi1lOWM4LTQ5ZTQtYjQ0NC03ODQ4YTVhNjkzNzgg\nUHJvamVjdCBDQTCCAaIwDQYJKoZIhvcNAQEBBQADggGPADCCAYoCggGBAOjBPIGV\nibl13jVwlXa7MgaEUtHxwTH0WxfyD4wmaogqa6uGotpmqiVxTGSHwQ4kGZTbOYSZ\nRqa5nrkd0vsl07yTTE/XNDiiEEbvda5EkJ6QzgES/Y98HXfnUZfGKpa0OS4EKVFY\n6Z08U6yMin8w1/nWyF4gLq8tbceu/3snYR8IZMYwsjiamt/A+t/qnSBdJXiLhpLK\nx3Dc6iqxSn8LiO/IvHkPLwZ8xQcllY++VYqhl531bxpb8j91LKPZsUMGhLfo6it9\nymJKC3PyWFaVUFlC+PCn1ES/ZpoiFca48yK4gtrm7pxTUO/Q0yHVtcZc/yNH+Jmc\n8qwU0UpPhM+Bm3dRKTNsR4qHLvjSzuCjMHsYR3CZnvqwbmufNgxhg9R2u0oDpEU+\nZKhxHBJI9i2nzarLu3yHpNuOGXdfbZnYCStxO+82SCp3TSD1l+2mA2TzchPwPlJr\nCHG5eztXKfAyR2TR/fgWGqhgLRhU3Cl6mEvvg5A/VrNARgJaALburFd50QIDAQAB\no0IwQDAdBgNVHQ4EFgQUmwdJhweXdpCqSqXOfq1wDteeChkwEgYDVR0TAQH/BAgw\nBgEB/wIBADALBgNVHQ8EBAMCAQYwDQYJKoZIhvcNAQEMBQADggGBALSWTWbD5eYm\nzbOHbEMawn2SOZOAr47DmaxIPW320dltgKWb7Y9mHZu2RMraqljNav5dfJ96QnzH\njQz0Sp64Vyf0twMHkIhHtqemS7/kbGSTnXFJWF1Ws20xmhpVSz35eNFud0jESNWz\nQJObqDx8BYIJkYzhgDmcKAkFd7NRaAEElZ/FDeUkdT+0JAy9d+sa7VNVo1QfB9th\n9Cv8BOWn6GVKDNLYLUxiYqvP+XB0BODscLGN0mS+zRkgSaMbUpZW8zsmsuVjGvmH\ny0t67oecnldHyf33JIm6hIbTk7UhzqCbdwaTOMXsF1LDqnC5MNQW3DF/yyxrBlLH\nIOxlPIMtuyuEh37/i7/jOYxuVsUpx17K3xsKrB+iKVdz+6a1gwEMGm0jD5uZnC/Y\n5fTdFQ8OzfaKAPmj26nECBVNfV7D3pRzpLgUV/0++SbveG0Mk9T6WC+hLTgoSkso\ne1tSlA5aveWSi0c0fzR5h0XzElqDj6KRGLKlkKwWAGENB7hDuiZpqA==\n-----END CERTIFICATE-----

# Настройка Key Store (переходим на надежный PKCS12)
spring.kafka.ssl.key-store-type=PKCS12
spring.kafka.ssl.key-store-location=classpath:keystore.p12
spring.kafka.ssl.key-store-password=GANTonePass
spring.kafka.ssl.key-password=GANTonePass